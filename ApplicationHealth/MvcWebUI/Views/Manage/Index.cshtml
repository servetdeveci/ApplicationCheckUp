@model ApplicationHealth.MvcWebUI.ManageModel.ProfileModel

@{
    ViewData["Title"] = "Profilim";
    Layout = "/Views/Shared/_LayoutAW.cshtml";
}

<div class="row">
    <div class="col-12 col-lg-6">
        <div class="card" id="">
            <div class="card-body">
                <h4 class="card-title m-b-0 align-self-center"><i class="fas fa-user"></i>"Profilim" </h4>
                <div class="ml-auto float-right">
                    <a onclick="window.history.back()" class="btn btn-xs  btn-outline-warning"><i class="fa fa-arrow-left"></i> ApplicationHealth.MvcWebUI"Geri"]</a>
                </div>
                <br />
                @*<div asp-validation-summary="All" class="text-danger"></div>*@
                <div class="form-group">
                    <label> ApplicationHealth.MvcWebUI"Kullanıcı Adı"]</label>
                    <input id="userName" asp-for="@Model.User.UserName" class="form-control" disabled />
                </div>
                <div class="form-group">
                    <label>ApplicationHealth.MvcWebUI"E-Posta"]</label>
                    @if (Model.User.EmailConfirmed)
                    {
                        <div class="input-group">
                            <input id="mail" asp-for="@Model.User.Email" class="form-control" />
                            <i class="glyphicon glyphicon-ok text-success"></i>
                        </div>
                    }
                    else
                    {
                        <input asp-for="@Model.User.Email" class="form-control" />
                        <button id="email-verification" type="submit" asp-page-handler="SendVerificationEmail" class="btn btn-link">ApplicationHealth.MvcWebUI"Doğrulama Kodu Gönder"]</button>
                    }
                    <span asp-validation-for="@Model.User.Email" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label>ApplicationHealth.MvcWebUI"Telefon Numarası"]</label>
                    <input id="phoneNumber" asp-for="@Model.User.PhoneNumber" class="form-control" />
                    <span asp-validation-for="@Model.User.PhoneNumber" class="text-danger"></span>
                </div>

                <button onclick="EditUser()" class="btn btn-primary">ApplicationHealth.MvcWebUI"Kaydet"]</button>

            </div>
        </div>

    </div>

    <div class="col-12 col-lg-6">
        <div class="card" id="">
            <div class="card-body">
                <h4 class="card-title m-b-0 align-self-center"><i class="fas fa-lock-open"></i> ApplicationHealth.MvcWebUI" Şifre Değiştirme"] </h4>
                <div class="ml-auto float-right">
                    <a onclick="window.history.back()" class="btn btn-xs  btn-outline-warning"><i class="fa fa-arrow-left"></i> ApplicationHealth.MvcWebUI"Geri"]</a>
                </div>
                <br />
                <form id="change-password-form" asp-controller="Manage" asp-action="ChangePasswordInProfile">
                    @*<div asp-validation-summary="All" class="text-danger"></div>*@
                    @Html.HiddenFor(model => model.User.UserName)
                    @Html.HiddenFor(model => model.User.Name)
                    <div class="form-group">
                        <label>ApplicationHealth.MvcWebUI"Mevcut Parola"]</label>
                        <input asp-for="@Model.ChangePasswordModel.OldPassword" class="form-control" />
                        <span asp-validation-for="@Model.ChangePasswordModel.OldPassword" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label>ApplicationHealth.MvcWebUI"Yeni Parola"]</label>
                        <input asp-for="@Model.ChangePasswordModel.NewPassword" class="form-control" />
                        <span asp-validation-for="@Model.ChangePasswordModel.NewPassword" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label>ApplicationHealth.MvcWebUI"Yeni Parolayı Doğrula"]</label>
                        <input asp-for="@Model.ChangePasswordModel.ConfirmPassword" class="form-control" />
                        <span asp-validation-for="@Model.ChangePasswordModel.ConfirmPassword" class="text-danger"></span>
                    </div>
                    <button type="submit" class="btn btn-primary">ApplicationHealth.MvcWebUI"Şifre Güncelle"]</button>

                </form>
            </div>
        </div>
    </div>
</div>



<script>
    $('#smsNotify').change(function () {
        if ($(this).is(':checked')) {
            $('#leak-value').closest('.form-group').show();
            $('#leak-value').focus();
        }
        else {
            $('#leak-value').closest('.form-group').hide();

        }
    });
   //KULLANIICI DÜZENLE
   function EditUser() {

      var userName = $("#userName").val();
      var mail = $("#mail").val();
      var phone = $("#phoneNumber").val();
       var smsNotify = $("#smsNotify").is(':checked');
       var leakNotifyValue = $("#leak-value").val();

      $.ajax({
         type: "POST",
         url: "/Manage/EditInProfile",
          data: { userName, mail, phone, smsNotify, leakNotifyValue },
         success: function (res) {
            $.toast({
               heading: res.head,
               text: res.message,
               position: 'top-right',
               loaderBg: '#ff6849',
               icon: res.status,
               hideAfter: 3500,
               stack: 6
            });
         },
         error: function (xhr, ajaxOptions, thrownError) {
            $.toast({
               heading: 'ApplicationHealth.MvcWebUI"Önemli!"]',
               text: xhr.status,
               position: 'top-right',
               loaderBg: '#ff6849',
               icon: xhr.status,
               hideAfter: 5000,
               stack: 6
            });
         },
      });
   }


</script>